# 总体设计

-------

## 功能设计

-------

### 对用户输入信息进行分析

[![image.png](https://i.postimg.cc/wxX6SkTX/image.png)](https://postimg.cc/XXvS5d5q)

用户账号登录会在命令行中进行提示"Sign in"，若没有账号提示可输入"Register"进行注册。

对于用户输入指令的读入会整合到一个scanner类中

其中，对于用户权限的分析会放在用户管理系统类中完成。

对于指令的分析会放在一个函数中完成，并返回一个指令类型。

### 对用户输入信息进行处理

实现一个类，其输入用户指令。执行用户输入指令。这里可以根据需求分析中的文档来划分用户指令的种类以及其处理方式。

### 对于底层文件管理

通过BP树来实现基本的文件搜索功能。账号信息会储存在map当中。除此之外会通过Memory River来实现存储对于销售记录、采购记录以及书籍信息的存储。  

## 用户交互设计

-------

### 基本格式

采取命令行风格，可以通过--help查看提示。

用户登录可以使用Sign_in关键字，注册使用Register。之后可以输入账号和密码。

登录帐号之后，会提示当前权限并说明可以进行Sign_out登出操作。之后每次进行操作都会将当前操作的账户名提示在命令头。

顾客可以通过Search_book查找书籍，其后可以使用-i来表示输入ISBN号查找，使用-n表示进行名字为关键词查找，使用-a表示进行作者为关键词查找，使用-k n表示通过关键词查找，其中n表示为关键词数量。这些提示词顺序可以不同，但是提示词后查找关键词必须匹配提示词顺序。提示词可以组合。  

顾客可以通过Buy来购买书籍，输入Buy后紧跟图书的ISBN号与一个整形量，表
示购买数目。

销售人员可以执行普通顾客的所有操作以及一部分额外操作。

通过Stock可以进货，此时需要输入图书的ISBN号。

通过Change_information可以修改图书信息，修改图书信息必须按照ISBN号为索引。

通过New_book可以录入新书。录入新书必须输入完整信息。

通过Create_account可以创建新账号，销售人员可以通过添加-a指定新账号权限（不能创建店主账号），新账号注册方式与游客一致。

店主有更多权限。  

店主可以通过Query来实现各类查询操作。具体而言，Query_stock可以检查购入信息，Query_sell可以检查销售信息，Query_profit来查询盈利。这些都可以通过指定-t l r来指定查询时间，不加为默认整体。

同时可以通过Query_log来查询日志，-e可以指定员工，-c可以指定顾客，若不加视为检测系统整体工作情况。

所有指令执行之后都会进行反馈，若成功则提示"Operation succeeded"，若失败则提示"Operation failed"并加上错误原因。

## 数据库设计

-------

用户名信息：map存放内存  
用户创建信息：memory river存放硬盘
用户密码信息：memory river存放硬盘  
购买记录：memory river存放硬盘  
书籍基本信息：memory river存放硬盘  
书籍索引信息：BP树存放硬盘  
修改记录：memory river存放硬盘  
销售记录：memory river存放硬盘
